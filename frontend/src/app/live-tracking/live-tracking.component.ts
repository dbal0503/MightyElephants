import { Component, AfterViewInit } from '@angular/core';
import * as L from 'leaflet';

@Component({
  selector: 'app-live-tracking',
  templateUrl: './live-tracking.component.html',
  styleUrls: ['./live-tracking.component.scss']
})
export class LiveTrackingComponent implements AfterViewInit {
  private map: any;

  // Add the route GeoJSON data directly in the component
  private routeGeoJSON: GeoJSON.FeatureCollection = {
   
  "features": [
    {
      "type": "Feature",
      "properties": {
        "mode": "drive",
        "waypoints": [
          {
            "location": [
              -73.578582,
              45.495247
            ],
            "original_index": 0
          },
          {
            "location": [
              -73.551346,
              45.504628
            ],
            "original_index": 1
          }
        ],
        "units": "metric",
        "distance": 3932,
        "distance_units": "meters",
        "time": 346.312,
        "legs": [
          {
            "distance": 3932,
            "time": 346.312,
            "steps": [
              {
                "from_index": 0,
                "to_index": 16,
                "distance": 286,
                "time": 25.908,
                "instruction": {
                  "text": "Drive northwest on Rue Guy."
                }
              },
              {
                "from_index": 16,
                "to_index": 129,
                "distance": 1876,
                "time": 139.915,
                "instruction": {
                  "text": "Turn right onto Rue Sherbrooke Ouest/138."
                }
              },
              {
                "from_index": 129,
                "to_index": 180,
                "distance": 1100,
                "time": 104.108,
                "instruction": {
                  "text": "Turn right onto Rue Saint-Urbain."
                }
              },
              {
                "from_index": 180,
                "to_index": 189,
                "distance": 149,
                "time": 18.173,
                "instruction": {
                  "text": "Turn left onto Rue Saint-Antoine Ouest."
                }
              },
              {
                "from_index": 189,
                "to_index": 228,
                "distance": 520,
                "time": 58.205,
                "instruction": {
                  "text": "Turn right onto Boulevard Saint-Laurent."
                }
              },
              {
                "from_index": 228,
                "to_index": 228,
                "distance": 0,
                "time": 0,
                "instruction": {
                  "text": "Your destination is on the right."
                }
              }
            ]
          }
        ]
      },
      "geometry": {
        "type": "MultiLineString",
        "coordinates": [
          [
            [
              -73.578509,
              45.495332
            ],
            [
              -73.579188,
              45.495623
            ],
            [
              -73.579219,
              45.495636
            ],
            [
              -73.579253,
              45.495651
            ],
            [
              -73.579327,
              45.495685
            ],
            [
              -73.579407,
              45.495722
            ],
            [
              -73.579437,
              45.495734
            ],
            [
              -73.579633,
              45.495821
            ],
            [
              -73.579962,
              45.495957
            ],
            [
              -73.580178,
              45.496039
            ],
            [
              -73.580288,
              45.496076
            ],
            [
              -73.580522,
              45.496155
            ],
            [
              -73.580755,
              45.496232
            ],
            [
              -73.581166,
              45.496367
            ],
            [
              -73.581591,
              45.496507
            ],
            [
              -73.581624,
              45.49652
            ],
            [
              -73.581745,
              45.49655
            ],
            [
              -73.581675,
              45.496623
            ],
            [
              -73.581649,
              45.496648
            ],
            [
              -73.581562,
              45.496745
            ],
            [
              -73.581169,
              45.497145
            ],
            [
              -73.581155,
              45.497159
            ],
            [
              -73.581107,
              45.49721
            ],
            [
              -73.581063,
              45.497256
            ],
            [
              -73.581046,
              45.497272
            ],
            [
              -73.580726,
              45.497602
            ],
            [
              -73.58036,
              45.497958
            ],
            [
              -73.580071,
              45.498254
            ],
            [
              -73.580056,
              45.498269
            ],
            [
              -73.580003,
              45.498324
            ],
            [
              -73.579953,
              45.498381
            ],
            [
              -73.579937,
              45.498397
            ],
            [
              -73.579628,
              45.498716
            ],
            [
              -73.579588,
              45.498757
            ],
            [
              -73.57954,
              45.498805
            ],
            [
              -73.57951,
              45.498836
            ],
            [
              -73.579382,
              45.498966
            ],
            [
              -73.579333,
              45.499018
            ],
            [
              -73.579309,
              45.499038
            ],
            [
              -73.579217,
              45.499133
            ],
            [
              -73.5788,
              45.499567
            ],
            [
              -73.578763,
              45.499603
            ],
            [
              -73.57871,
              45.499666
            ],
            [
              -73.578668,
              45.499723
            ],
            [
              -73.578643,
              45.499745
            ],
            [
              -73.578404,
              45.499987
            ],
            [
              -73.578292,
              45.5001
            ],
            [
              -73.578042,
              45.500349
            ],
            [
              -73.578028,
              45.500363
            ],
            [
              -73.577971,
              45.500421
            ],
            [
              -73.577918,
              45.500476
            ],
            [
              -73.577904,
              45.500489
            ],
            [
              -73.57735,
              45.501052
            ],
            [
              -73.577333,
              45.501069
            ],
            [
              -73.57729,
              45.501112
            ],
            [
              -73.577242,
              45.501159
            ],
            [
              -73.577226,
              45.501175
            ],
            [
              -73.576801,
              45.501602
            ],
            [
              -73.576659,
              45.501744
            ],
            [
              -73.576636,
              45.50177
            ],
            [
              -73.576566,
              45.501841
            ],
            [
              -73.576505,
              45.501905
            ],
            [
              -73.57648,
              45.501928
            ],
            [
              -73.576207,
              45.502202
            ],
            [
              -73.575978,
              45.50244
            ],
            [
              -73.57596,
              45.502457
            ],
            [
              -73.575922,
              45.502498
            ],
            [
              -73.575854,
              45.502568
            ],
            [
              -73.575834,
              45.502588
            ],
            [
              -73.575761,
              45.502664
            ],
            [
              -73.575359,
              45.503067
            ],
            [
              -73.575346,
              45.503079
            ],
            [
              -73.575289,
              45.503133
            ],
            [
              -73.575233,
              45.503191
            ],
            [
              -73.575212,
              45.503213
            ],
            [
              -73.574839,
              45.503593
            ],
            [
              -73.574808,
              45.503625
            ],
            [
              -73.574722,
              45.503711
            ],
            [
              -73.574659,
              45.503772
            ],
            [
              -73.574581,
              45.503847
            ],
            [
              -73.574515,
              45.503916
            ],
            [
              -73.574078,
              45.504364
            ],
            [
              -73.573559,
              45.504896
            ],
            [
              -73.57354,
              45.504912
            ],
            [
              -73.573512,
              45.50494
            ],
            [
              -73.573487,
              45.504965
            ],
            [
              -73.573431,
              45.50502
            ],
            [
              -73.573411,
              45.505041
            ],
            [
              -73.573211,
              45.50525
            ],
            [
              -73.573114,
              45.505361
            ],
            [
              -73.57302,
              45.505476
            ],
            [
              -73.572967,
              45.505562
            ],
            [
              -73.572747,
              45.505914
            ],
            [
              -73.572653,
              45.506071
            ],
            [
              -73.572643,
              45.506085
            ],
            [
              -73.572618,
              45.506126
            ],
            [
              -73.572546,
              45.506248
            ],
            [
              -73.572511,
              45.506305
            ],
            [
              -73.572496,
              45.506329
            ],
            [
              -73.572302,
              45.506651
            ],
            [
              -73.572241,
              45.506749
            ],
            [
              -73.57213,
              45.506929
            ],
            [
              -73.572119,
              45.506945
            ],
            [
              -73.572092,
              45.506993
            ],
            [
              -73.572063,
              45.507038
            ],
            [
              -73.572044,
              45.50707
            ],
            [
              -73.571957,
              45.507214
            ],
            [
              -73.571738,
              45.507588
            ],
            [
              -73.571721,
              45.507615
            ],
            [
              -73.571681,
              45.507683
            ],
            [
              -73.57164,
              45.507748
            ],
            [
              -73.571627,
              45.507769
            ],
            [
              -73.571337,
              45.508256
            ],
            [
              -73.571321,
              45.508282
            ],
            [
              -73.571278,
              45.50836
            ],
            [
              -73.571235,
              45.508432
            ],
            [
              -73.571222,
              45.508454
            ],
            [
              -73.571034,
              45.508818
            ],
            [
              -73.570846,
              45.509226
            ],
            [
              -73.570838,
              45.509247
            ],
            [
              -73.570808,
              45.509316
            ],
            [
              -73.570778,
              45.509395
            ],
            [
              -73.570769,
              45.509418
            ],
            [
              -73.570548,
              45.50994
            ],
            [
              -73.570323,
              45.510445
            ],
            [
              -73.57023,
              45.510666
            ],
            [
              -73.570084,
              45.511009
            ],
            [
              -73.570072,
              45.511038
            ],
            [
              -73.570059,
              45.511069
            ],
            [
              -73.570041,
              45.511108
            ],
            [
              -73.569923,
              45.511045
            ],
            [
              -73.568887,
              45.510567
            ],
            [
              -73.568601,
              45.510436
            ],
            [
              -73.567928,
              45.51012
            ],
            [
              -73.567561,
              45.50996
            ],
            [
              -73.567525,
              45.509945
            ],
            [
              -73.567446,
              45.509922
            ],
            [
              -73.5674,
              45.509907
            ],
            [
              -73.56725,
              45.509857
            ],
            [
              -73.56717,
              45.509829
            ],
            [
              -73.567101,
              45.509804
            ],
            [
              -73.567067,
              45.509791
            ],
            [
              -73.566384,
              45.50948
            ],
            [
              -73.566359,
              45.509468
            ],
            [
              -73.566302,
              45.509442
            ],
            [
              -73.565879,
              45.509245
            ],
            [
              -73.565801,
              45.509208
            ],
            [
              -73.56562,
              45.509122
            ],
            [
              -73.565353,
              45.508993
            ],
            [
              -73.564923,
              45.508786
            ],
            [
              -73.564887,
              45.508767
            ],
            [
              -73.564811,
              45.508731
            ],
            [
              -73.564724,
              45.50869
            ],
            [
              -73.563869,
              45.508302
            ],
            [
              -73.563803,
              45.508273
            ],
            [
              -73.56375,
              45.508249
            ],
            [
              -73.563602,
              45.508181
            ],
            [
              -73.562764,
              45.507801
            ],
            [
              -73.562737,
              45.507789
            ],
            [
              -73.562629,
              45.50774
            ],
            [
              -73.562494,
              45.507671
            ],
            [
              -73.562387,
              45.50762
            ],
            [
              -73.561232,
              45.507103
            ],
            [
              -73.560912,
              45.506955
            ],
            [
              -73.560896,
              45.506948
            ],
            [
              -73.560837,
              45.50692
            ],
            [
              -73.560778,
              45.506893
            ],
            [
              -73.560474,
              45.506754
            ],
            [
              -73.560364,
              45.506699
            ],
            [
              -73.559889,
              45.506467
            ],
            [
              -73.559869,
              45.506459
            ],
            [
              -73.559821,
              45.506443
            ],
            [
              -73.55976,
              45.506422
            ],
            [
              -73.559672,
              45.506379
            ],
            [
              -73.559277,
              45.506208
            ],
            [
              -73.559169,
              45.5062
            ],
            [
              -73.558853,
              45.506062
            ],
            [
              -73.558739,
              45.506013
            ],
            [
              -73.558418,
              45.505864
            ],
            [
              -73.558311,
              45.505814
            ],
            [
              -73.558249,
              45.505726
            ],
            [
              -73.558208,
              45.505786
            ],
            [
              -73.558108,
              45.505908
            ],
            [
              -73.558032,
              45.505999
            ],
            [
              -73.557653,
              45.506444
            ],
            [
              -73.557622,
              45.506479
            ],
            [
              -73.557587,
              45.506518
            ],
            [
              -73.557349,
              45.506789
            ],
            [
              -73.557332,
              45.506809
            ],
            [
              -73.557277,
              45.506877
            ],
            [
              -73.557228,
              45.506855
            ],
            [
              -73.557161,
              45.506825
            ],
            [
              -73.557145,
              45.506818
            ],
            [
              -73.55711,
              45.506803
            ],
            [
              -73.556798,
              45.506671
            ],
            [
              -73.556494,
              45.506547
            ],
            [
              -73.55645,
              45.506529
            ],
            [
              -73.556367,
              45.506494
            ],
            [
              -73.556286,
              45.506461
            ],
            [
              -73.556262,
              45.506451
            ],
            [
              -73.555799,
              45.506255
            ],
            [
              -73.555739,
              45.50623
            ],
            [
              -73.555653,
              45.506199
            ],
            [
              -73.555576,
              45.506169
            ],
            [
              -73.555551,
              45.50616
            ],
            [
              -73.554459,
              45.505781
            ],
            [
              -73.553854,
              45.505577
            ],
            [
              -73.553803,
              45.505562
            ],
            [
              -73.553753,
              45.505545
            ],
            [
              -73.553277,
              45.505385
            ],
            [
              -73.553187,
              45.505349
            ],
            [
              -73.553081,
              45.505291
            ],
            [
              -73.55301,
              45.505254
            ],
            [
              -73.552916,
              45.505203
            ],
            [
              -73.552877,
              45.505183
            ],
            [
              -73.552833,
              45.505158
            ],
            [
              -73.552675,
              45.505071
            ],
            [
              -73.552568,
              45.505012
            ],
            [
              -73.552469,
              45.504954
            ],
            [
              -73.552396,
              45.504913
            ],
            [
              -73.552293,
              45.504864
            ],
            [
              -73.552241,
              45.504839
            ],
            [
              -73.552158,
              45.50484
            ],
            [
              -73.551908,
              45.504855
            ],
            [
              -73.551878,
              45.504858
            ],
            [
              -73.551795,
              45.504862
            ],
            [
              -73.551746,
              45.504864
            ],
            [
              -73.5517,
              45.504867
            ],
            [
              -73.551378,
              45.504886
            ]
          ]
        ]
      }
    }
  ],
  "type": "FeatureCollection"

  };

  ngAfterViewInit(): void {
    // Lazy load Leaflet
    import('leaflet').then(L => {
      this.map = L.map('map').setView([45.495247, -73.578582], 13); // Set initial view closer to Montreal

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 18,
        minZoom: 3,
        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
      }).addTo(this.map);

      // Add the GeoJSON route to the map
      L.geoJSON(this.routeGeoJSON, {
        style: { color: 'blue', weight: 4 }, // Customize route style if desired
      }).addTo(this.map);
    });
  }
}